<!DOCTYPE html>
<html>
<head>
    <title>Product Description Settings Form</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.1/socket.io.js" integrity="sha512-q/dWJ3kcmjBLU4Qc47E4A9kTB4m3wuTY7vkFJDTZKjTs8jhyGQnaUrxa0Ytd0ssMZhbNua9hE+E7Qv1j+DyZwA==" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-tagsinput/0.8.0/bootstrap-tagsinput.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-tagsinput/0.8.0/bootstrap-tagsinput.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-beta.1/dist/css/select2.min.css" rel="stylesheet" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2-bootstrap-theme/0.1.0-beta.10/select2-bootstrap.min.css" rel="stylesheet" />
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-beta.1/dist/js/select2.min.js"></script>

    
    
    <style>
    .bootstrap-tagsinput {
        width: 100%;
        padding: 6px 12px;
        border-radius: .25rem;
        margin: 3px;
        line-height: 36px;
    }

    .bootstrap-tagsinput .tag {
        color: #fff;
        background-color: #e64445;
        border: none;
        padding: 5px;
        margin: 2px;
    }
    .gradient-custom {
            /* fallback for old browsers */
            background: #667eea;
        
            /* Chrome 10-25, Safari 5.1-6 */
            background: -webkit-linear-gradient(to right, rgba(102,126,234,1), rgba(118,75,162,1));
        
            /* W3C, IE 10+/ Edge, Firefox 16+, Chrome 26+, Opera 12+, Safari 7+ */
            background: linear-gradient(to right, rgba(102,126,234,1), rgba(118,75,162,1))
        }
        .nav-link, .nav-link:hover {
            color: #fff;
            text-decoration: none;
        }
    </style>
</head>
<body>
    <div class="d-flex align-items-center text-white px-3 h5 mb-4 justify-content-between gradient-custom" style="height: 55px">
        <div>Product Description Generator

                <a href="/processed_products/{{ project.id }}" class="btn btn-outline-light btn-sm">Processed products</a>

        </div>
        
        <div class="d-flex align-items-center">
            {% if current_user.is_authenticated %}
            <ul class="nav">
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" data-bs-toggle="dropdown" href="#" role="button" aria-expanded="false">{{ current_user.name }}</a>
                    <ul class="dropdown-menu">
                    <li><a class="dropdown-item" href="/">Projects</a></li>
                    <li><a class="dropdown-item" href="/users">Users</a></li>
                    <li><hr class="dropdown-divider"></li>
                    <li><a href="/logout" class="dropdown-item">Logout</a></li>
                    </ul>
                </li>
            </ul>
            {% endif %}
        </div>
    </div>
    
    <div class="container-fluid">
        <div class="row">
            <div class="col-md-4">
                <form id="settingsForm" class="mb-1">
                    <div class="accordion" id="settingsAccordion">
                        <!-- General Settings -->
                        <div class="accordion-item">
                            <h2 class="accordion-header" id="generalSettingsHeading">
                                <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#generalSettings" aria-expanded="true" aria-controls="generalSettings">
                                    General Settings
                                </button>
                            </h2>
                            <div id="generalSettings" class="accordion-collapse collapse show bg-light" aria-labelledby="generalSettingsHeading" data-bs-parent="#settingsAccordion">
                                <!-- App Settings Inputs -->
                                <div class="accordion-body">
                                <fieldset>
                                    <p class="text-black-50">Please provide the general configuration for the application.</p>
                                
                                    <div class="mb-3">
                                        <label for="url" class="form-label">Store URL</label>
                                        <input type="text" class="form-control" id="url" placeholder="URL" value="{{ project.store_url | default('', true) }}">
                                    </div>
                                    
                                    <div class="mb-3">
                                        <label for="X-CloudCart-ApiKey" class="form-label">X-CloudCart-ApiKey</label>
                                        <input type="text" class="form-control" id="X-CloudCart-ApiKey" value="{{ project.x_cloudcart_apikey | default('', true) }}">
                                    </div>
                                    
                                    <div class="mb-3">
                                        <label for="openai_key" class="form-label">OpenAI Key</label>
                                        <input type="text" class="form-control" id="openai_key" required>
                                    </div>
                                    
                                    <div class="mb-3">
                                        <label for="model" class="form-label">Model</label>
                                        <select class="form-select" id="model" name="model">
                                            <option value="gpt-3.5-turbo" {% if project.model == "gpt-3.5-turbo" or project.model is none %}selected{% endif %}>GPT-3.5-Turbo</option>
                                            <option value="gpt-4" {% if project.model == "gpt-4" %}selected{% endif %}>GTP-4</option>
                                        </select>
                                        <small class="text-muted">GPT-4 model is more campable but <mark>12 times expensive</mark> than GPT-3.5-Turbo.</small>
                                    </div>
                                
                                </fieldset>
                                </div>
                            </div>
                        </div>
                        <!-- Publishing Settings -->
                        <div class="accordion-item">
                            <h2 class="accordion-header" id="publishingSettingsHeading">
                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#publishingSettings" aria-expanded="false" aria-controls="publishingSettings">
                                    Publishing Settings
                                </button>
                            </h2>
                            <div id="publishingSettings" class="accordion-collapse collapse bg-light" aria-labelledby="publishingSettingsHeading" data-bs-parent="#settingsAccordion">
                                <div class="accordion-body">
                                    <fieldset>
                                        <div class="mb-3 form-check form-switch">
                                            <input type="checkbox" class="form-check-input" role="switch" id="enable_product_description" {% if project.enable_product_description %}checked{% endif %} onchange="toggleDescriptionAccordeon()">
                                            <label class="form-check-label" for="enable_product_description">Generate Product Description</label>
                                            <br>
                                            <small class="text-muted">If enabled, it will include the service <mark>Generate product description</mark></small>
                                        </div>
                                        <div class="mb-3 form-check form-switch" id="product_meta_description" {% if project.enable_product_description %}style="display: block"{% endif %}">
                                            <input type="checkbox" class="form-check-input" role="switch" id="enable_generate_meta_description" {% if project.enable_generate_meta_description %}checked{% endif %}>
                                            <label class="form-check-label" for="enable_generate_meta_description">Generate Meta Description</label>
                                            <br>
                                            <small class="text-muted">If enabled, it will include the service <mark>generating meta description</mark></small>
                                        </div>
                                        <div class="mb-3 form-check form-switch">
                                            <input type="checkbox" class="form-check-input" role="switch" id="enable_product_short_description" {% if project.enable_product_short_description %}checked{% endif %} onchange="toggleShortDescriptionAccordeon()">
                                            <label class="form-check-label" for="enable_product_short_description">Generate Short Description</label>
                                            <br>
                                            <small class="text-muted">If enabled, it will include the service <mark>generating shoty description</mark></small>
                                        </div>
                                        <div class="mb-3 form-check form-switch d-none">
                                            <input type="checkbox" class="form-check-input" id="test_mode" {% if project.test_mode or project.test_mode is none %}checked{% endif %}>
                                            <label class="form-check-label" for="test_mode">Test Mode is Active!</label>
                                            <br>
                                            <small class="text-muted">If disabled it will update the products at the store</small>
                                        </div>
                                        <div class="mb-3 form-check form-switch">
                                            <input type="checkbox" class="form-check-input" role="switch" id="print_prompt" {% if project.print_prompt %}checked{% endif %}>
                                            <label class="form-check-label" for="print_prompt">Print Prompt</label>
                                            <br>
                                            <small class="text-muted">It will print only the prompt that is used to generate description without generating it!</small>
                                        </div>
                                    </fieldset>
                                </div>
                            </div>
                        </div>
                        <!-- Website Settings -->
                        <div class="accordion-item">
                            <h2 class="accordion-header" id="websiteSettingsHeading">
                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#websiteSettings" aria-expanded="false" aria-controls="websiteSettings">
                                    Store Settings
                                </button>
                            </h2>
                            <div id="websiteSettings" class="accordion-collapse collapse bg-light" aria-labelledby="websiteSettingsHeading" data-bs-parent="#settingsAccordion">
                                <div class="accordion-body">
                                    <!-- Your website settings content here -->
                                    <fieldset>
                                        <p class="text-black-50">Please provide the website settings for the application.</p>
                                        
                                        <hr md-3> 
                                    
                                        <div class="mb-3">
                                            <label for="website_name" class="form-label">Store Name</label>
                                            <input type="text" class="form-control" id="website_name" placeholder="Website Name" value="{{ project.website_name | default('', true) }}">
                                        </div>
                                    
                                        <div class="mb-3">
                                            <label for="currency" class="form-label">Currency at the store</label>
                                            <input type="text" class="form-control" id="currency" placeholder="Example: лева or USD or anything you write" value="{{ project.currency | default('', true) }}">
                                        </div>
                                    
                                        <div class="mb-3">
                                            <label for="skip_products_with_description" class="form-label">Skip Products With More than <mark>(in words)</mark></label>
                                            <input type="text" class="form-control" id="skip_products_with_description" placeholder="Example: 20" value="{{ project.skip_products_with_description | default('', true) }}">
                                            <small class="text-muted">If the value is <mark>0</mark> it will not skip any products.</small>
                                        </div>
                                    
                                        <div class="mb-3">
                                            <label for="specific_product" class="form-label">Process only specific product ID:</label>
                                            <input type="text" class="form-control" id="specific_product" placeholder="Example: 3" value="{{ project.specific_product | default('', true) }}">
                                            <small class="text-muted">If <mark>empty</mark> it will process all products</small>
                                        </div>


                                        <div class="mb-3">
                                            <label for="only_category" class="form-label">Process only category:</label>
                                            <select id="only_category" class="form-control">
                                                <option value=""></option> 
                                                <option selected="selected" value="{{ project.only_category | default('', true) }}">{{ project.only_category_name | default('', true) }}</option>
                                            </select>
                                            <input type="hidden" id="only_category_name" value="{{ project.only_category_name | default('', true) }}">
                                            <small class="text-muted">If <mark>empty</mark> it will process all products from all categories</small>
                                        </div>
                                    
                                        <div class="mb-3">
                                            <label for="only_vendor" class="form-label">Process only vendor:</label>
                                            <select id="only_vendor" class="form-control">
                                                <option value=""></option> 
                                                <option selected="selected" value="{{ project.only_vendor | default('', true) }}">{{ project.only_vendor_name | default('', true) }}</option>
                                            </select>
                                            <input type="hidden" id="only_vendor_name" value="{{ project.only_vendor_name | default('', true) }}">
                                            <small class="text-muted">If <mark>empty</mark> it will process all products from all vendors</small>
                                        </div>
                                    
                                        <div class="mb-3">
                                            <label for="niche" class="form-label">Niche</label>
                                            <input type="text" class="form-control" id="niche" placeholder="Niche" value="{{ project.niche | default('', true) }}">
                                        </div>

                                        <hr md-3> 

                                        <div class="mb-3">
                                            <label for="free_delivery_over" class="form-label">Free Delivery price</label>
                                            <input type="text" class="form-control" id="free_delivery_over" placeholder="Example: 99"  value="{{ project.free_delivery_over | default('', true) }}">
                                        </div>
                                        
                                        <div class="mb-3 form-check form-switch">
                                            <input type="checkbox" class="form-check-input" id="mention_free_delivery_price" {% if project.mention_free_delivery_price %}checked{% endif %} >
                                            <label class="form-check-label" for="mention_free_delivery_price">Show the price for <mark>Free delivery</mark></label>
                                        </div>

                                        <hr md-3> 

                                        <div class="mb-3 form-check form-switch">
                                            <input type="checkbox" class="form-check-input" id="only_active" {% if project.only_active %}checked{% endif %}>
                                            <label class="form-check-label" for="only_active">Process only <mark>Active products</mark></label>
                                        </div>                                                                             
                                    </fieldset> 
                                </div>
                            </div>
                        </div>

                        <!-- Short description settings -->
                        <div class="accordion-item" id="product_short_description" style="display: none;">
                            <h2 class="accordion-header" id="shortDescriptionSettingsHeading">
                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#shortDescriptionSettings" aria-expanded="false" aria-controls="shortDescriptionSettings">
                                    Short Description Settings
                                </button>
                            </h2>
                            <div id="shortDescriptionSettings" class="accordion-collapse collapse bg-light" aria-labelledby="shortDescriptionSettingsHeading" data-bs-parent="#settingsAccordion">
                                <div class="accordion-body">
                                    <!-- Your website settings content here -->
                                    <fieldset>
                                        <p class="text-black-50">Please provide what type of information should be included in the generated short descriptions</p>
                                        <hr md-3>   
                                        <div class="mb-3">
                                            <label for="short_length" class="form-label">Length of the short description (in words)</label>
                                            <input type="range" class="form-range" value="{{ project.short_length | default(5, true) }}" min="5" max="100" step="5" id="short_length" oninput="updateShortLengthValue(this.value)">
                                            <span id="shortLengthValue">{{ project.short_length | default(5, true) }}</span>
                                        </div>

                                        <div class="mb-3">
                                            <label for="short_temperature" class="form-label">Temperature</label>
                                            <input type="range" class="form-range" value="{{ project.short_temperature | default(0, true) }}" min="0" max="2" step="0.1" id="short_temperature" oninput="updateShortTemperatureValue(this.value)">
                                            <span id="shortTemperatureValue">{{ project.short_temperature | default(0, true) }}</span>
                                        </div>
                                        </script>
                                        
                                        <div class="mb-3">
                                            <label for="short_language" class="form-label">Language</label>
                                            <input type="text" class="form-control" id="short_language" value="{{ project.short_language | default('', true) }}">
                                            <small class="text-muted">You can write any language here. Example: <mark>fluent Bulgarian</mark></small>
                                        </div>

                                        <hr md-3>                                  

                                        <div class="mb-3">
                                            <label class="form-label">GPT Role</label>
                                            <input type="text" class="form-control" id="short_purpose" placeholder="Tell the GPT its role..." value="{{ project.short_purpose | default('', true) }}">
                                            <small class="text-muted">Whith this field the prompt to GPT is started. The prompt starts with: <mark>You are ... (<i>here is your text</i>) .... copywriter</mark></small>
                                            <small class="text-muted">This is related with the style of writing. Example: <mark>Sales or Marketing or SEO.</mark></small>
                                        </div>
                                        <hr md-3> 
                                        <div class="form-check form-switch">
                                            <input class="form-check-input" type="checkbox" id="short_product_name" {% if project.short_product_name %}checked{% endif %}>
                                            <label class="form-check-label" for="short_product_name">Include Product Name</label>
                                        </div>
                                        <hr md-3> 
                                        <div class="form-check form-switch">
                                            <input class="form-check-input" type="checkbox" id="short_short_description" {% if project.short_short_description %}checked{% endif %}>
                                            <label class="form-check-label" for="short_short_description">Include Short Description</label>
                                        </div>
                                        <hr md-3> 
                                        <div class="form-check form-switch">
                                            <input class="form-check-input" type="checkbox" id="short_vendor_name" {% if project.short_vendor_name %}checked{% endif %}>
                                            <label class="form-check-label" for="short_vendor_name">Include Vendor Name</label>
                                        </div>
                                        <hr md-3> 
                                        <div class="form-check form-switch">
                                            <input class="form-check-input" type="checkbox" id="short_category_name" {% if project.short_category_name %}checked{% endif %}>
                                            <label class="form-check-label" for="short_category_name">Include Category Name</label>
                                        </div>
                                        <hr md-3> 
                                        <div class="form-check form-switch">
                                            <input class="form-check-input" type="checkbox" id="short_property_option_values" {% if project.short_property_option_values %}checked{% endif %}>
                                            <label class="form-check-label" for="short_property_option_values">Property Option Values</label>
                                        </div>
                                        <hr md-3> 
                                        <div class="form-check form-switch">
                                            <input class="form-check-input" type="checkbox" id="short_use_website_name" {% if project.short_use_website_name %}checked{% endif %}>
                                            <label class="form-check-label" for="short_use_website_name">Use Website Name</label>
                                        </div>
                                        <hr md-3> 
                                        <div class="md-3">
                                            <label class="form-label" for="short_additional_instructions">Additional instructions</label>
                                            <textarea class="form-control" id="short_additional_instructions" rows="3">{{ project.short_additional_instructions | default('', true) }}</textarea>
                                        </div>
                                    </fieldset>
                                </div>
                            </div>
                        </div>

                        <!-- Product description settings -->
                        <div class="accordion-item" id="product_description" style="display: none;">
                            <h2 class="accordion-header" id="textGenerateSettingsHeading">
                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#textGenerateSettings" aria-expanded="false" aria-controls="textGenerateSettings">
                                    Product Description Settings
                                </button>
                            </h2>
                            <div id="textGenerateSettings" class="accordion-collapse collapse bg-light" aria-labelledby="textGenerateSettingsHeading" data-bs-parent="#settingsAccordion">
                                <div class="accordion-body">
                                    <!-- Your website settings content here -->
                                    <fieldset>
                                        <p class="text-black-50">Please provide what type of information should be included in the generated product descriptions</p>
                                        <hr md-3>   
                                        <div class="mb-3">
                                            <label for="length" class="form-label">Lenght of the description (in words)</label>
                                            <input type="range" class="form-range" value="{{ project.length | default(10, true) }}" min="10" max="1200" step="10" id="length" oninput="updateLengthValue(this.value)">
                                            <span id="lengthValue">{{ project.length | default(10, true) }}</span>
                                        </div>

                                        <div class="mb-3">
                                            <label for="temperature" class="form-label">Temperature</label>
                                            <input type="range" class="form-range" value="{{ project.temperature | default(0, true) }}" min="0" max="2" step="0.1" id="temperature" oninput="updateTemperatureValue(this.value)">
                                            <span id="temperatureValue">{{ project.temperature | default(0, true) }}</span>
                                        </div>

                                        <div class="mb-3">
                                            <label for="language" class="form-label">Language</label>
                                            <input type="text" class="form-control" id="language" value="{{ project.language | default('', true) }}">
                                            <small class="text-muted">You can write any language here. Example: <mark>fluent Bulgarian</mark></small>
                                        </div>

                                        <hr md-3>                                  

                                        <div class="mb-3">
                                            <label class="form-label">GPT Role</label>
                                            <input type="text" class="form-control" id="purpouse" placeholder="Tell the GPT its role..." value="{{ project.purpouse | default('', true) }}">
                                            <small class="text-muted">Whith this field the prompt to GPT is started. The prompt starts with: <mark>You are ... (<i>here is your text</i>) .... copywriter</mark></small>
                                            <small class="text-muted">This is related with the style of writing. Example: <mark>Sales or Marketing or SEO.</mark></small>
                                        </div>
                                        <hr md-3>
                                        <div class="form-check form-switch">
                                            <input class="form-check-input" type="checkbox" id="product_name" {% if project.product_name %}checked{% endif %}>
                                            <label class="form-check-label" for="product_name">Include Product Name</label>
                                        </div>
                                        <hr md-3>
                                        <div class="form-check form-switch">
                                            <input class="form-check-input" type="checkbox" id="price_from" {% if project.price_from %}checked{% endif %}>
                                            <label class="form-check-label" for="price_from">Consider Product Price </label><br />
                                            <smal class="text-muted">It is required if you will use free delivery mention. This option <mark>DOES NOT</mark> include the price into the text</smal>
                                        </div>
                                        <hr md-3>
                                        <div class="form-check form-switch">
                                            <input class="form-check-input" type="checkbox" id="show_price" {% if project.show_price %}checked{% endif %}>
                                            <label class="form-check-label" for="show_price">Include The Price</label>
                                            <br>
                                            <small class="text-muted">If enabled, it will <mark>include the actual price of the product</mark></small>
                                        </div>
                                        <hr md-3>
                                        <div class="form-check form-switch">
                                            <input class="form-check-input" type="checkbox" id="short_description" {% if project.short_description %}checked{% endif %}>
                                            <label class="form-check-label" for="short_description">Include Short Description</label>
                                            <br>
                                            <small class="text-muted">May increase the price of the service because of the lenght of the prompt. Enable it <mark>Only</mark> if there is valuable information</small>
                                        </div>
                                        <hr md-3>
                                        <div class="form-check form-switch">
                                            <input class="form-check-input" type="checkbox" id="description" {% if project.description %}checked{% endif %}>
                                            <label class="form-check-label" for="description">Include Description</label>
                                            <br>
                                            <small class="text-muted">May increase the price of the service because of the lenght of the prompt. Enable it <mark>Only</mark> if you want to keep parts of the current description.</small>
                                        </div>
                                        <hr md-3>
                                        <div class="form-check form-switch">
                                            <input class="form-check-input" type="checkbox" id="vendor_name" {% if project.vendor_name %}checked{% endif %}>
                                            <label class="form-check-label" for="vendor_name">Include Vendor Name</label>
                                        </div>
                                        <hr md-3>
                                        <div class="form-check form-switch" data-bs-toggle="tooltip" data-bs-placement="top" 
                                        title="This is your tooltip text">
                                            <input class="form-check-input" type="checkbox" id="category_name" 
                                                   {% if project.category_name %}checked{% endif %}>
                                            <label class="form-check-label" for="category_name" >Include Category Name</label>
                                        </div>
                                        
                                        <hr md-3>
                                        <div class="form-check form-switch">
                                            <input class="form-check-input" type="checkbox" id="property_option_values" {% if project.property_option_values %}checked{% endif %}>
                                            <label class="form-check-label" for="property_option_values">Property Option Values</label>
                                        </div>
                                        <hr md-3>
                                        <div class="form-check form-switch">
                                            <input class="form-check-input" type="checkbox" id="use_feature_desc" {% if project.use_feature_desc %}checked{% endif %}>
                                            <label class="form-check-label" for="use_feature_desc">Use <mark>feature/benefit</mark> dichotomy description. Works good if Property option values are enabled</label><br />
                                            <small class="text-muted">Example: Buying a dishwasher will liberate you from having to remove food residue and stains by hand</small>
                                        </div>
                                        <hr md-3>
                                        <div class="form-check form-switch">
                                            <input class="form-check-input" type="checkbox" id="use_interesting_fact" {% if project.use_interesting_fact %}checked{% endif %}>
                                            <label class="form-check-label" for="use_interesting_fact">Use <mark>interesting facts</mark> </label><br />
                                            <small class="text-muted">Will generate an interesting fact of the product that will give additional value to the customer</small>
                                        </div>
                                        <hr md-3>
                                        <div class="form-check form-switch">
                                            <input class="form-check-input" type="checkbox" id="use_hidden_benefit" {% if project.use_hidden_benefit %}checked{% endif %}>
                                            <label class="form-check-label" for="use_hidden_benefit">Use <mark>hidden benefit</mark> </label><br />
                                            <small class="text-muted">Will generate a hidden bennefit of the product that will give additional value to the customer</small>
                                        </div>
                                        <hr md-3>
                                        <div class="form-check form-switch">
                                            <input class="form-check-input" type="checkbox" id="use_website_name" {% if project.use_website_name %}checked{% endif %}>
                                            <label class="form-check-label" for="use_website_name">Use Website Name</label>
                                        </div>
                                        
                                        <hr md-3>
                                        <div class="md-3">
                                            <label class="form-label" for="additional_instructions">Additional instructions</label>
                                            <textarea class="form-control" id="additional_instructions" rows="3">{{ project.additional_instructions | default('', true) }}</textarea>
                                        </div>
                                        <hr md-3>
                                        <div class="md-3">
                                            <label class="form-label" for="system_instructions">Overwrite System instructions</label>
                                            <textarea class="form-control" id="system_instructions" rows="6" placeholder="You must add html tags to the text and you must bold important parts and words! Do not use H1 tags, use H2 and H3 tags instead! The links at the text should be accross the entire text not only at the end!">{{ project.system_instructions | default('', true) }}</textarea>
                                            <small class="text-muted">Add instructions only if you know what you are doing!</small>
                                        </div>
                                    </fieldset>
                                </div>
                            </div>
                        </div>
                    
                        <!-- SEO Settings -->
                        <div class="accordion-item">
                            <h2 class="accordion-header" id="seoSettingsHeading">
                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#seoSettings" aria-expanded="false" aria-controls="seoSettings">
                                    SEO Settings <small>(Optional but Recommended)</small>
                                </button>
                            </h2>
                            <div id="seoSettings" class="accordion-collapse collapse bg-light" aria-labelledby="seoSettingsHeading" data-bs-parent="#settingsAccordion">
                                <div class="accordion-body">
                                    <!-- Your SEO settings content here -->
                                    <fieldset>
                                        <p class="text-black-50">The following section is optional. If enabled it will include valueable information at the description in <mark>Feature/Benefit dichotomy</mark> style and make it SEO friendly. </p>
                                        <small class="text-muted">It will increase the price of the service by <mark>3x times!</mark></small>
                                        <hr md-3> 
                                        <div class="form-check form-switch">
                                            <input type="checkbox" class="form-check-input" id="use_seo_package" name="use_seo_package" {% if project.use_seo_package %}checked{% endif %} onchange="toggleSEOSettings()">
                                            <label class="form-check-label" for="use_seo_package">Use SEO Package</label>
                                        </div>
                                        
                                        <div id="seo_fields" style="display:none;">
                                            <hr md-3> 
                                            <div class="form-check form-switch">
                                                <input type="checkbox" class="form-check-input" id="e_e_a_t" name="e_e_a_t" {% if project.e_e_a_t %}checked{% endif %}>
                                                <label class="form-check-label" for="e_e_a_t">Enable E-E-A-T writing style</label><br />
                                                <small class="text-muted">Read more <a href="https://developers.google.com/search/blog/2022/12/google-raters-guidelines-e-e-a-t" target="_blank">here</a> about the Google Guidlines</small>
                                            </div>
                                            <hr md-3> 
                                            <div class="form-check form-switch">
                                                <input type="checkbox" class="form-check-input" id="link_to_product" name="link_to_product" {% if project.link_to_product %}checked{% endif %}>
                                                <label class="form-check-label" for="link_to_product">Link to the Product name</label>
                                            </div>
                                            <hr md-3> 
                                            <div class="form-check form-switch">
                                                <input type="checkbox" class="form-check-input" id="link_to_category" name="link_to_category" {% if project.link_to_category %}checked{% endif %}>
                                                <label class="form-check-label" for="link_to_category">Link to the Category name</label>
                                            </div>
                                            <hr md-3> 
                                            <div class="form-check form-switch">
                                                <input type="checkbox" class="form-check-input" id="link_to_vendor" {% if project.link_to_vendor %}checked{% endif %}>
                                                <label class="form-check-label" for="link_to_vendor">Link to the Vendor name</label>
                                            </div>
                                            <hr md-3> 
                                            <div class="form-check form-switch">
                                                <input type="checkbox" class="form-check-input" id="link_to_more_from_same_vendor_and_category" {% if project.link_to_more_from_same_vendor_and_category %}checked{% endif %}>
                                                <label class="form-check-label" for="link_to_more_from_same_vendor_and_category">Link to view more products</label>
                                                <small>The link will be generated to the category with included filter by Vendor</small>
                                            </div>
                                            <hr md-3> 
                                            
                                            <div class="form-check form-switch">
                                                <input type="checkbox" class="form-check-input" id="link_keyword_to_product" {% if project.link_keyword_to_product %}checked{% endif %}>
                                                <label class="form-check-label" for="link_keyword_to_product">Add Links to Keywords Into the Text</label>
                                            </div>
                                            <div class="mb-3">

                                                <hr md-3> 

                                                <label for="use_keywords" class="form-label">Number of Keywords</label>
                                                <select class="form-select" id="use_keywords">
                                                    <option value="0" {% if project.use_keywords == 0 or project.use_keywords is none %}selected{% endif %}>Don't generate keywords</option>
                                                    <option value="1" {% if project.use_keywords == 1 %}selected{% endif %}>Generate 1 keyword</option>
                                                    <option value="2" {% if project.use_keywords == 2 %}selected{% endif %}>Generate 2 keywords</option>
                                                    <option value="3" {% if project.use_keywords == 3 %}selected{% endif %}>Generate 3 keywords</option>
                                                    <option value="4" {% if project.use_keywords == 4 %}selected{% endif %}>Generate 4 keywords</option>
                                                    <option value="5" {% if project.use_keywords == 5 %}selected{% endif %}>Generate 5 keywords</option>
                                                </select>
                                                
                                            </div>
                                            <div class="mb-3">
                                                <label for="use_free_keywords" class="form-label md-3">Use Free Keywords</label>
                                                <input type="text" class="form-control" data-role="tagsinput" id="use_free_keywords" value="{{ project.use_free_keywords | default('', true) }}">
                                            </div>
                                            <hr md-3> 
                                            <div class="mb-3">
                                                <label for="keywords_density" class="form-label">Keywords Density</label>
                                                <select class="form-select" id="keywords_density">
                                                    <option value="1" {% if project.keywords_density == 1 or project.keywords_density is none %}selected{% endif %}>Use 1 keyword into description</option>
                                                    <option value="2" {% if project.keywords_density == 2 %}selected{% endif %}>Use 2 times the generated keywords</option>
                                                    <option value="3" {% if project.keywords_density == 3 %}selected{% endif %}>Use 3 times the generated keywords</option>
                                                    <option value="4" {% if project.keywords_density == 4 %}selected{% endif %}>Use 4 times the generated keywords</option>
                                                    <option value="5" {% if project.keywords_density == 5 %}selected{% endif %}>Use 5 times the generated keywords</option>
                                                    <option value="6" {% if project.keywords_density == 6 %}selected{% endif %}>Use 6 times the generated keywords</option>
                                                    <option value="7" {% if project.keywords_density == 7 %}selected{% endif %}>Use 7 times the generated keywords</option>
                                                    <option value="8" {% if project.keywords_density == 8 %}selected{% endif %}>Use 8 times the generated keywords</option>
                                                    <option value="9" {% if project.keywords_density == 9 %}selected{% endif %}>Use 9 times the generated keywords</option>
                                                    <option value="10" {% if project.keywords_density == 10 %}selected{% endif %}>Use 10 times the generated keywords</option>
                                                </select>
                                                
                                            </div>
                                            
                                            <div class="mb-3">
                                                <label for="link_keyword_density" class="form-label">Link Keyword Density</label>
                                                <select class="form-select" id="link_keyword_density">
                                                    <option value="1" {% if project.link_keyword_density == 1 or project.link_keyword_density is none %}selected{% endif %}>Add link to 1 keyword</option>
                                                    <option value="2" {% if project.link_keyword_density == 2 %}selected{% endif %}>Add link to 2 keywords</option>
                                                    <option value="3" {% if project.link_keyword_density == 3 %}selected{% endif %}>Add link to 3 keywords</option>
                                                    <option value="4" {% if project.link_keyword_density == 4 %}selected{% endif %}>Add link to 4 keywords</option>
                                                    <option value="5" {% if project.link_keyword_density == 5 %}selected{% endif %}>Add link to 5 keywords</option>
                                                    <option value="6" {% if project.link_keyword_density == 6 %}selected{% endif %}>Add link to 6 keywords</option>
                                                    <option value="7" {% if project.link_keyword_density == 7 %}selected{% endif %}>Add link to 7 keywords</option>
                                                    <option value="8" {% if project.link_keyword_density == 8 %}selected{% endif %}>Add link to 8 keywords</option>
                                                    <option value="9" {% if project.link_keyword_density == 9 %}selected{% endif %}>Add link to 9 keywords</option>
                                                    <option value="10" {% if project.link_keyword_density == 10 %}selected{% endif %}>Add link to 10 keywords</option>
                                                </select>
                                                
                                            </div>
                                            

                                            <!-- Other SEO fields go here -->
                                        </div>
                                    </fieldset>
                                </div>
                            </div>
                        </div>
                    </div>
                
    </div>
    <div class="col-md-8">
        <div class="card" style="position: sticky; top: 0;">
            <div class="card-header border-0">
                <a href="" id="clear-records-button">Terminal</a>
            </div>
            <div class="card-body p-0">
                <pre id="output" class="border p-2 m-3" style="height: 72vh; overflow: auto; background-color: black; color: rgb(244, 244, 244); white-space: pre-wrap;">
                </pre>
            </div>
            <div class="d-flex justify-content-between m-3">
                <div>
                    <button id="stopButton" type="button" class="btn btn-danger ps-3 pe-3 pb-3 pt-3" onclick="cancelProcess()" disabled>Process not running</button>
                    <button id="calculateButton" class="btn btn-secondary ps-3 pe-3 pb-3 pt-3">Calculate</button>
                </div>

                <div class="mb-3 form-check form-switch">
                    <input type="checkbox" class="form-check-input" id="test_mode2" {% if project.test_mode or project.test_mode is none %}checked{% endif %} onchange="toggleTestMode()">
                    <label class="form-check-label" for="test_mode2">Test Mode is Active!</label>
                    <br>
                    <small class="text-muted">If disabled it will update the products at the store</small>
                </div>
                
                
                <button type="button" id="generateButton" onclick="startProcess()" value="Generate and Save" class="btn btn-primary ps-3 pe-3 pb-3 pt-3" data-project-id="{{ project.id }}">Generate and Save</button>


                
            </form>
            </div>                 
        </div>
    </div>
    <script>
        function cancelProcess() {
            // this function will disable the button
            var $stopButton = $("#stopButton");
            $stopButton.prop("disabled", true);
            $stopButton.text("Canceling...");
        }
        function startProcess() {
            var $generateButton = $("#generateButton");
            $generateButton.prop("disabled", true);
            $generateButton.text("Generating...");
            $generateButton.css("background-color", "#e64445");

            handleFormSubmit();
        }
/*
        $(document).ready(function() {
            var $generateButton = $("#generateButton");
            var $stopButton = $("#stopButton");  // Define stop button
            var project_id = $generateButton.data("project-id");

            var intervalId = setInterval(function() {
                $.get("/get_status", {project_id: project_id}, function(data) {
                    if (data['in_progress'] == 1) {
                        $generateButton.prop("disabled", true);
                        $generateButton.text("Generating...");
                        $generateButton.css("background-color", "#e64445");

                        $stopButton.prop("disabled", false);
                        $stopButton.text("Cancel the process");
                        $stopButton.css("background-color", "#e64445");
                    } else {
                        $generateButton.prop("disabled", false);
                        $generateButton.text("Generate and Save");
                        $generateButton.css("background-color", "");

                        $stopButton.prop("disabled", true);
                        $stopButton.text("Process not running"); // or any other text
                        $stopButton.css("background-color", "");
                    }
                });
            }, 1000);
        });
*/
        
    </script>
    <script type="text/javascript" charset="utf-8">
        $(document).ready(function() {
            var socket = io.connect('https://' + document.domain + ':' + location.port + '/');
            var $generateButton = $("#generateButton");
            var $stopButton = $("#stopButton");
        
            // Request to get in_progress status
            $.ajax({
                url: '/get_status',
                type: 'GET',
                data: { 'project_id': '{{ project.id }}' }, // Pass project_id if necessary
                success: function(response) {
                    if(response.in_progress) {
                        // Disable the button and change the text and color
                        $generateButton.prop("disabled", true);
                        $generateButton.text("Generating...");
                        $generateButton.css("background-color", "#e64445");

                        $stopButton.prop("disabled", false);
                        $stopButton.text("Cancel the process");
                        $stopButton.css("background-color", "#e64445");
                        console.log("Process is running");
                    }
                },
                error: function(error) {
                    console.log(error);
                }
            });
        
            socket.on('connect', function() {
                socket.emit('join', { 'project_id': '{{ project.id }}', 'username': '{{ current_user.name }}' });
            });
        
            socket.on('log', function(msg) {
                document.getElementById('output').textContent += msg.data + '\n';
        
                // Scroll to the bottom
                var outputDiv = document.getElementById("output");
                outputDiv.scrollTop = outputDiv.scrollHeight;
        
                if (msg.data.includes('Started')) {
                    $generateButton.prop("disabled", true);
                    $generateButton.text("Generating...");
                    $generateButton.css("background-color", "#e64445");
        
                    $stopButton.prop("disabled", false);
                    $stopButton.text("Cancel the process");
                    $stopButton.css("background-color", "#e64445");
                } else if (msg.data.toLowerCase().includes('completed') || msg.data.toLowerCase().includes('error')  || msg.data.toLowerCase().includes('stopped') || msg.data.toLowerCase().includes('ended')) {
                    $generateButton.prop("disabled", false);
                    $generateButton.text("Generate and Save");
                    $generateButton.css("background-color", "");
        
                    $stopButton.prop("disabled", true);
                    $stopButton.text("Process not running"); // or any other text
                    $stopButton.css("background-color", "");
                }
            })
        });
    </script>
    
    
    
    
        
    <script>
        window.onload = function() {
        if (document.getElementById('use_seo_package').checked) {
            document.getElementById('seo_fields').style.display = 'block';
        }
        /// hide product short description accordeaon when enable_product_short_description is false
        if (document.getElementById('enable_product_short_description').checked) {
            document.getElementById('product_short_description').style.display = 'block';
        }
        if (document.getElementById('enable_product_description').checked) {
            document.getElementById('product_description').style.display = 'block';
            document.getElementById('product_meta_description').style.display = 'block';
        }else{
            document.getElementById('product_meta_description').style.display = 'none';
        }
        if (document.getElementById('test_mode2').checked) {
            document.getElementById('test_mode').checked = true;
        }
    };
    </script>
    <script>
        function toggleTestMode() {
            var testMode2 = document.getElementById("test_mode2");
            var testMode = document.getElementById("test_mode");
            if (testMode2.checked == true){
                testMode.checked = true;
            } else {
                testMode.checked = false;
            }
        }
    </script>
    <script>
        function toggleTestMode2() {
            var testMode2 = document.getElementById("test_mode");
            var testMode = document.getElementById("test_mode2");
            if (testMode.checked == true){
                testMode2.checked = true;
            } else {
                testMode2.checked = false;
            }
        }
    </script>
    <script>
        function toggleSEOSettings() {
            var checkBox = document.getElementById("use_seo_package");
            var seoFields = document.getElementById("seo_fields");
            if (checkBox.checked == true){
                seoFields.style.display = "block";
            } else {
                seoFields.style.display = "none";
            }
        }
    </script>
    <script>
        function toggleShortDescriptionAccordeon() {
            var checkBox = document.getElementById("enable_product_short_description");
            var hideShortDesc = document.getElementById("product_short_description");
            if (checkBox.checked == true){

                hideShortDesc.style.display = "block";
            } else {
                hideShortDesc.style.display = "none";

            }
        }
    </script>
    <script>
        function toggleDescriptionAccordeon() {
            var checkBox = document.getElementById("enable_product_description");
            var hideProductDesc = document.getElementById("product_description");
            var hideMetaDesc = document.getElementById("product_meta_description");
            if (checkBox.checked == true){
                hideProductDesc.style.display = "block";
                hideMetaDesc.style.display = "block";
            } else {
                hideProductDesc.style.display = "none";
                hideMetaDesc.style.display = "none";
                document.getElementById("enable_generate_meta_description").checked = false;
            }
        }
    </script>
    <script>
        function updateTemperatureValue(val) {
            document.getElementById('temperatureValue').textContent = val;
        }
        function updateLengthValue(val) {
            document.getElementById('lengthValue').textContent = val;
        }
        function updateShortTemperatureValue(val) {
            document.getElementById('shortTemperatureValue').textContent = val;
        }
        function updateShortLengthValue(val) {
            document.getElementById('shortLengthValue').textContent = val;
        }
    </script>
    <script>
        function handleFormSubmit() {
            // Collect settings data from the form
            var data = {
                "app_settings": {
                    "X-CloudCart-ApiKey": $('#X-CloudCart-ApiKey').val(),
                    "openai_key": $('#openai_key').val(),
                    "model": $('#model').val(),
                    "temperature": parseInt($('#temperature').val()) || 0,
                    "url": $('#url').val(),
                    "website_name": $('#website_name').val(),
                    "use_seo_package": $('#use_seo_package').is(':checked'),
                    "currency": $('#currency').val(),
                    "length": parseInt($('#length').val()) || 0,
                    "test_mode": $('#test_mode').is(':checked'),
                    "print_prompt": $('#print_prompt').is(':checked'),
                    "only_active": $('#only_active').is(':checked'),
                    "skip_products_with_description": parseInt($('#skip_products_with_description').val()) || 0,
                    "specific_product": $('#specific_product').val(),
                    "only_category": $('#only_category').val(),
                    "only_category_name": $('#only_category_name').val(),
                    "only_vendor": $('#only_vendor').val(),
                    "only_vendor_name": $('#only_vendor_name').val(),
                    "language": $('#language').val(),
                    "niche": $('#niche').val(),
                    "free_delivery_over": parseInt($('#free_delivery_over').val()) || 99999999,
                    "mention_free_delivery_price": $('#mention_free_delivery_price').is(':checked'),
                    "enable_product_description": $('#enable_product_description').is(':checked'),
                    "enable_product_short_description": $('#enable_product_short_description').is(':checked'),
                    "enable_generate_meta_description": $('#enable_generate_meta_description').is(':checked'),
                },
                "short_description_settings": {
                    "short_purpose": $('#short_purpose').val(),
                    "short_length": parseInt($('#short_length').val(), 0),
                    "short_temperature": parseFloat($('#short_temperature').val()) || 0,
                    "short_language": $('#short_language').val(),
                    "short_product_name": $('#short_product_name').is(':checked'),
                    "short_short_description": $('#short_short_description').is(':checked'),
                    "short_vendor_name": $('#short_vendor_name').is(':checked'),
                    "short_category_name": $('#short_category_name').is(':checked'),
                    "short_property_option_values": $('#short_property_option_values').is(':checked'),
                    "short_use_website_name": $('#short_use_website_name').is(':checked'),
                    "short_additional_instructions": $('#short_additional_instructions').val(),

                },
                "seo_settings": {
                    "link_to_product": $('#link_to_product').is(':checked'),
                    "link_to_category": $('#link_to_category').is(':checked'),
                    "link_to_vendor": $('#link_to_vendor').is(':checked'),
                    "link_to_more_from_same_vendor_and_category": $('#link_to_more_from_same_vendor_and_category').is(':checked'),
                    "use_keywords": parseInt($('#use_keywords').val()) || 0,
                    "keywords_density": parseInt($('#keywords_density').val()) || 0,
                    "use_free_keywords": $('#use_free_keywords').val(),
                    "link_keyword_to_product": $('#link_keyword_to_product').is(':checked'),
                    "link_keyword_density": parseInt($('#link_keyword_density').val()) || 0,
                    "e_e_a_t": $('#e_e_a_t').is(':checked'),
                },
                "prompt_settings": {
                    "purpouse": $('#purpouse').val(),
                    "product_name": $('#product_name').is(':checked'),
                    "price_from": $('#price_from').is(':checked'),
                    "show_price": $('#show_price').is(':checked'),
                    "short_description": $('#short_description').is(':checked'),
                    "description": $('#description').is(':checked'),
                    "vendor_name": $('#vendor_name').is(':checked'),
                    "category_name": $('#category_name').is(':checked'),
                    "property_option_values": $('#property_option_values').is(':checked'),
                    "use_website_name": $('#use_website_name').is(':checked'),
                    "use_feature_desc": $('#use_feature_desc').is(':checked'),
                    "additional_instructions": $('#additional_instructions').val(),
                    "system_instructions": $('#system_instructions').val(),
                    "use_interesting_fact": $('#use_interesting_fact').is(':checked'),
                    "use_hidden_benefit": $('#use_hidden_benefit').is(':checked'),
                }
                // Get other SEO and prompt settings data...
            };
            // change the color and text of the Generate button, and disable it


            //let url = window.location.href;
            //let projectId = url.substring(url.lastIndexOf('/') + 1);
            
            // Include the project_id in the data object
            let projectId = '{{ project.id }}';
            data["project_id"] = projectId;
            // POST the data as JSON to the new endpoint to save settings
            fetch('/save_settings/' + projectId, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(data)
                })
            .then(response => {
                if (!response.ok) {
                    throw new Error("HTTP error " + response.status);
                    
                }

                // Once settings are saved successfully, call the /set endpoint
                return fetch('/set', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(data)
                });
            })
            .then(response => {
                if (!response.ok) {
                    throw new Error("HTTP error " + response.status);
                }

                // restore the original color, text, and enable the Generate button after getting a successful response

                //$('#stopButton').prop('disabled', true).text('Cancel the process');
            })
            .catch(function(error) {

            });
        }
        $(document).ready(function() {
            $('#settingsForm').submit(function(e) {
                e.preventDefault();

                startProcess();
            });
        });

    </script>
    <script>
        $(document).ready(function() {
        // Select the "Generate" button
        $('#stopButton').click(function() {
            $.ajax({
                url: '/stop_process',
                type: 'POST',
                contentType: 'application/json; charset=utf-8',
                data: JSON.stringify({ "project_id": "{{ project.id }}" }),
            })
            .done(function(response) {
            })
            .fail(function(error) {
                console.log(error);
                // Here you can handle errors
            });
        });
    });

    </script>
    <script>
    $(document).ready(function() {
        $('#calculateButton').click(function() {
        
        $(this).prop("disabled", true);

        var data = {
            "project_id": "{{ project.id }}",
            "app_settings": {
                "X-CloudCart-ApiKey": $('#X-CloudCart-ApiKey').val(),
                "openai_key": $('#openai_key').val(),
                "model": $('#model').val(),
                "temperature": parseInt($('#temperature').val()) || 0,
                "url": $('#url').val(),
                "website_name": $('#website_name').val(),
                "use_seo_package": $('#use_seo_package').is(':checked'),
                "currency": $('#currency').val(),
                "length": parseInt($('#length').val()) || 0,
                "test_mode": $('#test_mode').is(':checked'),
                "print_prompt": $('#print_prompt').is(':checked'),
                "only_active": $('#only_active').is(':checked'),
                "skip_products_with_description": parseInt($('#skip_products_with_description').val()) || 0,
                "specific_product": $('#specific_product').val(),
                "only_category": $('#only_category').val(),
                "only_category_name": $('#only_category_name').val(),
                "only_vendor": $('#only_vendor').val(),
                "only_vendor_name": $('#only_vendor_name').val(),
                "language": $('#language').val(),
                "niche": $('#niche').val(),
                "free_delivery_over": parseInt($('#free_delivery_over').val()) || 99999999,
                "mention_free_delivery_price": $('#mention_free_delivery_price').is(':checked'),
                "enable_product_description": $('#enable_product_description').is(':checked'),
                "enable_product_short_description": $('#enable_product_short_description').is(':checked'),
                "enable_generate_meta_description": $('#enable_generate_meta_description').is(':checked'),
            },
            "seo_settings": {
                "link_to_product": $('#link_to_product').is(':checked'),
                "link_to_category": $('#link_to_category').is(':checked'),
                "link_to_vendor": $('#link_to_vendor').is(':checked'),
                "link_to_more_from_same_vendor_and_category": $('#link_to_more_from_same_vendor_and_category').is(':checked'),
                "use_keywords": parseInt($('#use_keywords').val()) || 0,
                "keywords_density": parseInt($('#keywords_density').val()) || 0,
                "use_free_keywords": $('#use_free_keywords').val(),
                "link_keyword_to_product": $('#link_keyword_to_product').is(':checked'),
                "link_keyword_density": parseInt($('#link_keyword_density').val()) || 0
            },
            "prompt_settings": {
                "purpouse": $('#purpouse').val(),
                "product_name": $('#product_name').is(':checked'),
                "price_from": $('#price_from').is(':checked'),
                "show_price": $('#show_price').is(':checked'),
                "short_description": $('#short_description').is(':checked'),
                "description": $('#description').is(':checked'),
                "vendor_name": $('#vendor_name').is(':checked'),
                "category_name": $('#category_name').is(':checked'),
                "property_option_values": $('#property_option_values').is(':checked'),
                "use_website_name": $('#use_website_name').is(':checked'),
                "additional_instructions": $('#additional_instructions').val(),
                "system_instructions": $('#system_instructions').val(),
            }
            // Get other SEO and prompt settings data...
        };

        $.ajax({
            url: '/calculate',
            type: 'POST',
            data: JSON.stringify(data),
            contentType: 'application/json; charset=utf-8',
            dataType: 'json',
            async: true,
            success: function(msg) {
                $("#calculateButton").prop("disabled", false);
            },
            error: function(error) {
                $("#calculateButton").prop("disabled", false);
            }
        });
    });
});

    </script>
    <script>
        $(document).ready(function() {
            // Handle button click event
            $('#clear-records-button').click(function() {
                // Send AJAX request
                $.ajax({
                    url: '/clear_processed_records',
                    type: 'POST',
                    data: JSON.stringify({ "project_id": "{{ project.id }}" }),  // Replace with your project ID
                    contentType: 'application/json',
                    success: function(response) {
                        // Handle success response
                        console.log(response);
                        alert('Processed records cleared!');
                    },
                    error: function(xhr, status, error) {
                        // Handle error response
                        console.error(xhr.responseText);
                        alert('Error clearing processed records.');
                    }
                });
            });
        });
    </script>
    <script>
    $(document).ready(function() {

        // Assuming these are the relevant app_settings
        var data = {
            "app_settings": {
                "X-CloudCart-ApiKey": $('#X-CloudCart-ApiKey').val(),
                "url": $('#url').val(),
            }
        };

        $('#only_category').select2({
            placeholder: "Select a category",
            minimumResultsForSearch: Infinity,
            allowClear: true,
            minimumInputLength: 0,
            theme: "bootstrap",
            ajax: {
                url: '/get_all_categories',  // URL to the API that returns the categories
                type: 'POST',
                contentType: 'application/json; charset=utf-8',
                dataType: 'json',
                delay: 50, // wait 250 milliseconds before triggering the request
                data: function (params) {
                    return JSON.stringify(data);
                },
                processResults: function (data) {
                    // Transforms the top-level key of the response object from 'products' to 'results'
                    return {
                        results: data.categories.map(function(item) {
                            return {
                                id: item.id,
                                text: item.attributes.name // assuming the name is in the 'attributes' object
                            };
                        })
                    };
                },
                cache: true
            }
        }).on('select2:select', function (e) {
            var data = e.params.data;
            $('#only_category_name').val(data.text);
        }).on('select2:unselect', function (e) {
            $('#only_category_name').val('');
        });

    });  
    </script>
    

<script>
$(document).ready(function() {

    // Assuming these are the relevant app_settings
    var data = {
        "app_settings": {
            "X-CloudCart-ApiKey": $('#X-CloudCart-ApiKey').val(),
            "url": $('#url').val(),
        }
    };

    $('#only_vendor').select2({
        placeholder: "Select a vendor",
        minimumResultsForSearch: Infinity,
        allowClear: true,
        minimumInputLength: 0,
        theme: "bootstrap",
        ajax: {
            url: '/get_all_vendors',  // URL to the API that returns the products
            type: 'POST',
            contentType: 'application/json; charset=utf-8',
            dataType: 'json',
            delay: 50, // wait 250 milliseconds before triggering the request
            data: function (params) {
                return JSON.stringify(data);
            },
            processResults: function (data) {
                // Transforms the top-level key of the response object from 'products' to 'results'
                return {
                    results: data.vendors.map(function(item) {
                        return {
                            id: item.id,
                            text: item.attributes.name // assuming the name is in the 'attributes' object
                        };
                    })
                };
            },
            cache: true
        }
    }).on('select2:select', function (e) {
        var data = e.params.data;
        $('#only_vendor_name').val(data.text);
    }).on('select2:unselect', function (e) {
        $('#only_vendor_name').val('');
    });

});  
</script>
    
</body>
</html>